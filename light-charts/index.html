<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title></title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/reset.css">
</head>

<body>

    <div class="hello">
        <div class="chart-title">
            <div>
                <h3><span id="charTitle" class="charTitle chart-title"></span><span class="chart-title">外国直接投资净流入法国（BoP）</span></h3>
            </div>
        </div>
        <div class="box-data-chart">
            <div id="data-chart" class="bar-chart"></div>
        </div>
        <div class="country-select">
            <ul class="select-opion" id="list">
                <li id="china" class="select-option">中国</li>
                <li id="els" class="select-option">俄罗斯</li>
                <li id="eng" class="select-option">英国</li>
                <li id="french" class="select-option">法国</li>
                <li id="american" class="select-option">美国</li>
            </ul>
        </div>
        <!-- <div class="table">
            <div style="display:flex;flex-direction:row;justify-content:center">
                <div class="data-part1" style>
                    <p>
                        <span class="table-year">2007年</span>
                        <span class="table-value"></span>
                    </p>
                    <p>
                        <span class="table-year">2008年</span>
                        <span class="table-value"></span>
                    </p>
                    <p>
                        <span class="table-year">2009年</span>
                        <span class="table-value"></span>
                    </p>
                    <p>
                        <span class="table-year">2010年</span>
                        <span class="table-value"></span>
                    </p>
                </div>
                <div class="data-part1">
                    <p>
                        <span class="table-year">2011年</span>
                        <span class="table-value"></span>
                    </p>
                    <p>
                        <span class="table-year">2012年</span>
                        <span class="table-value"></span>
                    </p>
                    <p>
                        <span class="table-year">2013年</span>
                        <span class="table-value"></span>
                    </p>
                    <p>
                        <span class="table-year">2014年</span>
                        <span class="table-value"></span>
                    </p>
                </div>
                <div class="data-part1">
                    <p>
                        <span class="table-year">2015年</span>
                        <span class="table-value"></span>
                    </p>
                    <p>
                        <span class="table-year">2016年</span>
                        <span class="table-value"></span>
                    </p>
                    <p>
                        <span class="table-year">2017年</span>
                        <span class="table-value"></span>
                    </p>
                    <p>
                        <span class="table-year">2018年</span>
                        <span class="table-value"></span>
                    </p>
                </div>
            </div>
        </div> -->
    </div>
    <!-- <script src='js/echarts.min.js'></script> -->
    <!-- <script src='js/jquery-3.2.1.min.js'></script> -->
    <script src="https://cdn.bootcss.com/echarts/4.3.0-rc.2/echarts-en.common.min.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <script>
        var arrCounrtyData = []
        var country = ''
        var key = '中国'
        var lineTableData = []; // 数据处理成表格
        let oneOfLineToFixed0 = []; //柱子上取整
        let oneOfLine0 = []; //
        window.onload = function() {
            // switchData('中国')
            switchData('中国')
        }
        $(document).ready(function(key) {
            var ul = document.getElementById("list");
            var ul_child = ul.getElementsByTagName('li');

            for (var i = 0; i < ul_child.length; i++) {
                ul_child[i].index = i;
                ul_child[i].onclick = function() {
                    var j = this.index;
                    key = $(".select-option")[j].innerText;
                    $(".charTitle")[0].innerText = key;
                    switchData(key)
                }
            }
            country = key

        });

        function switchData(key) {
            switch (key) {
                case "中国":
                    arrCounrtyData = [156249000000.00, 171535000000.00, 131057000000.00, 243703000000.00, 280072000000.00, 241214000000.00, 290928000000.00, 268097000000.00, 242489000000.00, 174750000000.00, 166084000000.00, 203492000000.00]

                    getChart()
                    break;
                case "俄罗斯":
                    arrCounrtyData = [55873680000.00, 74782910000.00, 36583100000.00, 43167780000.00, 55083630000.00, 50587560000.00, 69218890000.00, 22031340000.00, 6852970000.00, 32538900000.00, 28557440000.00, 8816180000.00]

                    getChart()
                    break;
                case "英国":
                    arrCounrtyData = [209515000000.00, 253454000000.00, 14547108445.00, 66734551294.00, 27012050072.00, 46750789728.00, 54473175400.00, 58890445253.00, 45333483122.00, 265811000000.00, 121249000000.00, 58646386419.00]

                    getChart()
                    break;
                case "法国":
                    arrCounrtyData = [83780962091.00, 67999194663.00, 18380195793.00, 38899924638.00, 44191741840.00, 32950453828.00, 31589259642.00, 5809580555.00, 42803255076.00, 45349681278.00, 47335618619.00, 66816525298.00]

                    getChart()
                    break;
                case "美国":
                    arrCounrtyData = [346613000000.00, 341092000000.00, 161083000000.00, 264039000000.00, 263497000000.00, 250345000000.00, 288131000000.00, 251856000000.00, 509087000000.00, 494457000000.00, 354828000000.00, 267081000000.00]

                    getChart()
                    break;

            }
        }

        function getChart() {
            // // 构造表格
            // var tabledata = []
            // arrCounrtyData.forEach(element => {
            //     tabledata.push((Number(element) / 1000000000).toFixed(2));
            // });
            // var tableValue = document.getElementsByClassName('table-value')
            // for (var i = 0, len = tabledata.length; i < len; i++) {
            //     tableValue[i].innerHTML = tabledata[i]
            // }
            // 为了柱状图显示不重叠，去掉小数点后位数
            arrCounrtyData.forEach(element => {
                oneOfLineToFixed0.push((Number(element) / 1000000000).toFixed(0));
            });
            var dataChart = echarts.init(document.getElementById("data-chart"));
            let option = {
                title: {
                    text: "",
                    textStyle: {
                        color: "#fff",
                        padding: "3em"
                    }
                },
                tooltip: {
                    trigger: "axis"
                },
                legend: {
                    data: [{
                        name: " ",
                        icon: "circle",
                        textStyle: {
                            color: "#fff" // 图例文字颜色
                        }
                    }]
                },
                xAxis: {
                    type: "category",
                    name: "年",
                    boundaryGap: false,
                    data: [2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018],
                    axisLine: {
                        lineStyle: {
                            color: "#fff"
                                // width:8,//这里是为了突出显示加上的
                        }
                    },
                    axisLabel: {
                        interval: 0, //横轴信息全部显示
                        rotate: -45, //度角倾斜显示
                        // formatter: function(value) {
                        //     //只显示五个字 其余省略号
                        //     return value.length > 5 ? value.substring(0, 5) + "..." : value;
                        // }
                    }
                },
                yAxis: {
                    show: true,
                    type: "value",
                    name: "美元",
                    // name: "人",
                    axisLabel: {
                        formatter: "{value}亿"
                    },
                    axisLine: {
                        lineStyle: {
                            color: "#fff"
                                // width:8,//这里是为了突出显示加上的
                        }
                    }
                },
                grid: {
                    left: "1%",
                    top: 40,
                    bottom: 10,
                    right: "8%",
                    // height:60,
                    containLabel: true
                },
                series: [{
                    name: country,
                    type: "bar",
                    stack: "总量",
                    // 显示数值
                    itemStyle: {
                        normal: {
                            label: {
                                show: true
                            }
                        }
                    },
                    barWidth: '15',
                    data: oneOfLineToFixed0,
                    color: "orange"
                }]
            };
            dataChart.setOption(option);
            oneOfLineToFixed0 = []

        }

        // function getRequest() {
        //     let url = window.location.search; //获取url中"?"符后的字串
        //     if (url.indexOf("=") != -1 && url.indexOf("&") != -1) {
        //         let leftIndex = url.indexOf("=") + 1;
        //         let rightIndex = url.indexOf("&");
        //         let str = url.slice(leftIndex, rightIndex); //提取=后&前的内容
        //         this.optionChange(decodeURI(str));
        //     } else {
        //         // let leftIndex = ;
        //         let str = url.slice(url.indexOf("=") + 1); //提取=后的内容，比如主键
        //         this.optionChange(decodeURI(str));
        //     }
        // }
    </script>
</body>

</html>